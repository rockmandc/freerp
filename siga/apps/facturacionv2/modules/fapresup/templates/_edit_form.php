<?php
// auto-generated by PropelCidesa
// date: 2008/11/18 10:34:25
?>
<?php echo form_tag('fapresup/save', array(
  'id'        => 'sf_admin_edit_form',
  'name'      => 'sf_admin_edit_form',
  'multipart' => true,
)) ?>

<?php echo object_input_hidden_tag($fapresup, 'getId') ?>
<?php echo javascript_include_tag('dFilter','ajax','tools','observe','facturacion/presupuesto') ?>
<?php use_helper('Javascript', 'tabs', 'Grid') ?>

<?php echo input_hidden_tag('fapresup[codcli]', $fapresup->getCodcli()) ?>
<?php echo input_hidden_tag('nrofilas', $numreg) ?>

<h2 class="h2" onclick="javascript: return $('divPresupuesto').toggle();"><?php echo __('Presupuesto') ?></h2>
<fieldset id="sf_fieldset_presupuesto" class="">

<div class="form-row" id="divPresupuesto">

<table>
  <tr>
    <th>
		<div id="divrefpre">
		  <?php echo label_for('fapresup[refpre]', __($labels['fapresup{refpre}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapresup{refpre}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapresup{refpre}')): ?>
		    <?php echo form_error('fapresup{refpre}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_input_tag($fapresup, 'getRefpre', array (
		  'size' => 8,
		  'control_name' => 'fapresup[refpre]',
		  'maxlength' => 8,
		  'onBlur'  => "javascript:event.keyCode=13; enters(event,this.value);",
		  'readonly'  =>  true,
		)); echo $value ? $value : '&nbsp;' ?>

		    </div>
		</div>
    </th>
    <th>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
    <th>
		<div id="divfecpre">
		  <?php echo label_for('fapresup[fecpre]', __($labels['fapresup{fecpre}' ]), 'class="required" Style="text-align:left; width:100px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapresup{fecpre}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapresup{fecpre}')): ?>
		    <?php echo form_error('fapresup{fecpre}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_input_date_tag($fapresup, 'getFecpre', array (
		  'rich' => true,
		  'calendar_button_img' => '/sf/sf_admin/images/date.png',
		  'control_name' => 'fapresup[fecpre]',
		  'date_format' => 'dd/MM/yyyy',
		  'maxlength' => 10,
		  'onkeyup' => "javascript: mascara(this,'/',patron,true)",
		  'readonly'  =>  $fapresup->getId()!='' ? true : false ,
		 ),date('Y-m-d')); echo $value ? $value : '&nbsp;' ?>

		    </div>
		</div>
    </th>
    <th>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
    <th>
		<div id="divcodmon">
		  <?php echo label_for('fapresup[tipmon]', __($labels['fapresup{tipmon}' ]), 'class="required" Style="text-align:left; width:100px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapresup{tipmon}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapresup{tipmon}')): ?>
		    <?php echo form_error('fapresup{tipmon}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php echo select_tag('fapresup[tipmon]', options_for_select($moneda,$fapresup->getTipmon(), 'include_custom=Seleccione Uno'), array(
		  'readonly'  =>  $fapresup->getId()!='' ? true : false ,
		  'onBlur'=> remote_function(array(
		        'url'      => 'fapresup/ajax',
		        'complete' => 'AjaxJSON(request, json)',
		        'with' => "'ajax=2&fecha='+$('fapresup_fecpre').value+'&cajtexmos=fapresup_valmon&codigo='+this.value"
		        ))
		  )); ?></div><div  style="display:none"> <?php $value = object_input_tag($fapresup, 'getValmon', array (
		  'size' => 7,
		  'control_name' => 'fapresup[valmon]',
		)); echo $value ? $value : '&nbsp;' ?>
			  </div>
		    </div>
		</div>
    </th>
  </tr>
</table>

<br/>

<table>
  <tr>
    <th>
            <div id="divcodprg">
                <?php echo label_for('fapresup[codprg]', __($labels['fapresup{codprg}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
                <div class="content<?php if ($sf_request->hasError('fapresup{codprg}')): ?> form-error<?php endif; ?>">
                <?php if ($sf_request->hasError('fapresup{codprg}')): ?>
                <?php echo form_error('fapresup{codprg}', array('class' => 'form-error-msg')) ?>
                <?php endif; ?>

                <?php echo select_tag('fapresup[codprg]', options_for_select(FadefprgPeer::getProgramasVigentes(),$fapresup->getCodprg(),'include_custom=Seleccione uno'),
                        array('onChange' =>  "javascript:validarCambioCombos()")) ?>
                </div>
            </div>
        </th>
    </tr>
</table>

<table>
  <tr>
    <th>
		<div id="divrifpro">
		  <?php echo label_for('fapresup[rifpro]', __($labels['fapresup{rifpro}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapresup{rifpro}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapresup{rifpro}')): ?>
		    <?php echo form_error('fapresup{rifpro}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

			<?php $value = object_input_tag($fapresup, 'getRifpro', array (
			  'size' => 20,
			  'control_name' => 'fapresup[rifpro]',
			  'readonly'  =>  $fapresup->getId()!='' ? true : false ,
			  'onKeyDown' => "javascript:return dFilter (event.keyCode, this)",
			  'onBlur'=> remote_function(array(
						  'url'      => 'fapresup/ajax',
						  'script' => true,
						  'complete' => 'AjaxJSON(request, json)',
						  'condition' => "$('fapresup_rifpro').value != ''",
			  			  'with' => "'ajax=1&cajtexmos=fapresup_nompro&codigo='+this.value"
						  ))
			  )); echo $value ? $value : '&nbsp;' ?>
			<th>
			   <?php echo  button_to_modal('...',cross_app_link_to('herramientas','catalogo').'/metodo/Rifcli_Fapedidov2/clase/Facliente/frame/sf_admin_edit_form/obj1/fapresup_rifpro/obj2/fapresup_nompro/campo1/rifpro/campo2/nompro','','','botoncat')?></th>
			</th>
			<th>
			  <?php $value = object_input_tag($fapresup, 'getNompro', array (
			  'size' => 80,
			  'disabled' => true,
			  'control_name' => 'fapresup[nompro]',
			)); echo $value ? $value : '&nbsp;' ?>
			</th>
		    </div>
		</div>
    </th>
  </tr>
</table>

<br>

<table>
  <tr>
    <th>
        <div id="divtipcte">
          <?php echo label_for('fapresup[tipcte]', __($labels['fapresup{tipcte}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
          <div class="content<?php if ($sf_request->hasError('fapresup{tipcte}')): ?> form-error<?php endif; ?>">
          <?php if ($sf_request->hasError('fapresup{tipcte}')): ?>
            <?php echo form_error('fapresup{tipcte}', array('class' => 'form-error-msg')) ?>
          <?php endif; ?>

          <?php $value = object_input_tag($fapresup, 'getTipcte', array (
          'disabled' => true,
          'size' => '80',
          'control_name' => 'fapresup[tipcte]',
        )); echo $value ? $value : '&nbsp;' ?>
            </div>
        </div>
    </th>
    <th>
        <?php echo input_hidden_tag('fapresup[codtip]', $fapresup->getCodtipcli()) ?>
    </th>
</table>

<br>

<div id="divconcre">
     <?php echo label_for('fapresup[concre]', __($labels['fapresup{concre}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
        <div class="content<?php if ($sf_request->hasError('fapresup{concre}')): ?> form-error<?php endif; ?>">
     <?php if ($sf_request->hasError('fapresup{concre}')): ?>
        <?php echo form_error('fapresup{concre}', array('class' => 'form-error-msg')) ?>
     <?php endif; ?>

      <?php echo radiobutton_tag('fapresup[concre]', 'R', false,array('onClick'=> remote_function(array(
           'update'   => 'combnew',
           'url'      => 'fapresup/ajax',
           'complete' => 'AjaxJSON(request, json)',
           'script'   => true,
           'with'   => "'ajax=6&codprg='+$('fapresup_codprg').value+'&cliente='+$('fapresup_rifpro').value+'&codigo='+this.value"
            ))))        ."CrÃ©dito".'&nbsp;&nbsp;';
            echo radiobutton_tag('fapresup[concre]', 'C', false,array('onClick'=> remote_function(array(
           'update'   => 'combnew',
           'url'      => 'fapresup/ajax',
           'complete' => 'AjaxJSON(request, json)',
           'script'   => true,
           'with'   => "'ajax=6&codprg='+$('fapresup_codprg').value+'&cliente='+$('fapresup_rifpro').value+'&codigo='+this.value"
            ))))."   Contado";?>
          
     </div>
</div>
<br>

<table>
    <tr>
        <th>
            <div id="divcodconpag">
            <?php echo label_for('fapresup[faconpag_id]', __($labels['fapresup{faconpag_id}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
            <div class="content<?php if ($sf_request->hasError('fapresup{faconpag_id}')): ?> form-error<?php endif; ?>">
            <?php if ($sf_request->hasError('fapresup{faconpag_id}')): ?>
            <?php echo form_error('fapresup{faconpag_id}', array('class' => 'form-error-msg')) ?>
            <?php endif; ?>

                <div id="combnew">
                    <?php echo select_tag('fapresup[faconpag_id]', options_for_select(FaconpagPeer::TipPagos(),$fapresup->getFaconpagId()),
                            array('onChange' =>  "javascript:validarCambioCombos()")) ?>
                </div>
            </div>
            </div>
        </th>
    </tr>
</table>
<br>

<table>
  <tr>
    <th>
		<div id="divdirpro">
		  <?php echo label_for('fapresup[dirpro]', __($labels['fapresup{dirpro}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapresup{dirpro}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapresup{dirpro}')): ?>
		    <?php echo form_error('fapresup{dirpro}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_input_tag($fapresup, 'getDirpro', array (
		  'disabled' => true,
		  'size' => '100',
		  'control_name' => 'fapresup[dirpro]',
		)); echo $value ? $value : '&nbsp;' ?>
		    </div>
		</div>
    </th>
</table>

<br>

<table>
    <th>
		<div id="divtelpro">
		  <?php echo label_for('fapresup[telpro]', __($labels['fapresup{telpro}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapresup{telpro}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapresup{telpro}')): ?>
		    <?php echo form_error('fapresup{telpro}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_input_tag($fapresup, 'getTelpro', array (
		  'disabled' => true,
		  'control_name' => 'fapresup[telpro]',
		)); echo $value ? $value : '&nbsp;' ?>
		    </div>
		</div>
    </th>
  </tr>
</table>

<br/>

<table>
  <tr>
    <th>
		<div id="divdespre">
		  <?php echo label_for('fapresup[despre]', __($labels['fapresup{despre}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapresup{despre}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapresup{despre}')): ?>
		    <?php echo form_error('fapresup{despre}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_textarea_tag($fapresup, 'getDespre', array (
		  'size' => '90x3',
		  'maxlength'=>250,
		  'control_name' => 'fapresup[despre]',
		)); echo $value ? $value : '&nbsp;' ?>
		    </div>
		</div>
    </th>
  </tr>
</table>

<br/>

<table>
  <tr>
    <th>
		<div id="divforsol">
		  <?php echo label_for('fapresup[faforsol_id]', __($labels['fapresup{faforsol_id}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapresup{faforsol_id}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapresup{faforsol_id}')): ?>
		    <?php echo form_error('fapresup{faforsol_id}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_select_tag($fapresup, 'getFaforsolId', array (
		  'related_class' => 'Faforsol',
		  'control_name' => 'fapresup[faforsol_id]',
		  'include_blank' => true,
		)); echo $value ? $value : '&nbsp;' ?>

		    </div>
		</div>
    </th>
  </tr>
</table>

<br/>

<table>
  <tr>
    <th>
	<div id="divmondesc">
	  <?php echo label_for('fapresup[monrgo]', __($labels['fapresup{monrgo}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
	  <div class="content<?php if ($sf_request->hasError('fapresup{monrgo}')): ?> form-error<?php endif; ?>">
	  <?php if ($sf_request->hasError('fapresup{monrgo}')): ?>
	    <?php echo form_error('fapresup{monrgo}', array('class' => 'form-error-msg')) ?>
	  <?php endif; ?>

	  <?php $value = object_input_tag($fapresup, array('getMonrgo',true), array (
	  'size' => 10,
	  'onKeyPress' => 'return validaDecimal(event)',
	  'onBlur' => 'event.keyCode=13;return formatoDecimal(event,this.id)',
	  'control_name' => 'fapresup[monrgo]',
	)); echo $value ? $value : '&nbsp;' ?>
	    </div>
	</div>
    </th>
    <th>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
    <th>
	<div id="divmondesc">
	  <?php echo label_for('fapresup[mondesc]', __($labels['fapresup{mondesc}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
	  <div class="content<?php if ($sf_request->hasError('fapresup{mondesc}')): ?> form-error<?php endif; ?>">
	  <?php if ($sf_request->hasError('fapresup{mondesc}')): ?>
	    <?php echo form_error('fapresup{mondesc}', array('class' => 'form-error-msg')) ?>
	  <?php endif; ?>

	  <?php $value = object_input_tag($fapresup, array('getMondesc',true), array (
	  'size' => 10,
	  'onKeyPress' => 'return validaDecimal(event)',
	  'onBlur' => 'event.keyCode=13;return formatoDecimal(event,this.id)',
	  'control_name' => 'fapresup[mondesc]',
	)); echo $value ? $value : '&nbsp;' ?>
	    </div>
	</div>
    </th>
    <th>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
    <th>
		<div id="divmonpre">
		  <?php echo label_for('fapresup[monpre]', __($labels['fapresup{monpre}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapresup{monpre}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapresup{monpre}')): ?>
		    <?php echo form_error('fapresup{monpre}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_input_tag($fapresup, array('getMonpre',true), array (
		  'size' => 10,
		  'readonly'  =>  true,
		  'onKeyPress' => 'return validaDecimal(event)',
		  'onBlur' => 'event.keyCode=13;return formatoDecimal(event,this.id)',
		  'control_name' => 'fapresup[monpre]',
		)); echo $value ? $value : '&nbsp;' ?>
		    </div>
		</div>
    </th>
  </tr>
</table>
</div>
</fieldset>

<h2 class="h2" onclick="javascript: return $('divDetalle Presupuesto').toggle();"><?php echo __('Detalle Presupuesto') ?></h2>
<fieldset id="sf_fieldset_detalle_presupuesto" class="">

<div class="form-row" id="divDetalle Presupuesto">
<div id="divgrid">
  <?php echo label_for('fapresup[grid]', __($labels['fapresup{grid}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapresup{grid}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapresup{grid}')): ?>
    <?php echo form_error('fapresup{grid}', array('class' => 'form-error-msg')) ?>
  <?php endif; ?>

  <?php $value = get_partial('grid', array('type' => 'edit', 'fapresup' => $fapresup)); echo $value ? $value : '&nbsp;' ?>
    </div>
</div>
<br/>
</div>

<h2 class="h2" onclick="javascript: return $('divForma de Despacho').toggle();"><?php echo __('Forma de Despacho') ?></h2>
<fieldset id="sf_fieldset_forma_de_despacho" class="">

<div class="form-row" id="divForma de Despacho">
<div id="divfordes">
  <?php echo label_for('fapresup[fafordes_id]', __($labels['fapresup{fafordes_id}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapresup{fafordes_id}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapresup{fafordes_id}')): ?>
    <?php echo form_error('fapresup{fafordes_id}', array('class' => 'form-error-msg')) ?>
  <?php endif; ?>

  <?php $value = object_select_tag($fapresup, 'getFafordesId', array (
  'related_class' => 'Fafordes',
  'control_name' => 'fapresup[fafordes_id]',
  'include_blank' => true,
)); echo $value ? $value : '&nbsp;' ?>
</div>
<br/>
</div>
</fieldset>
<h2 class="h2" onclick="javascript: return $('divObservaciÃ³n').toggle();"><?php echo __('ObservaciÃ³n') ?></h2>
<fieldset id="sf_fieldset_observaci__n" class="">

<div class="form-row" id="divObservaciÃ³n">
<div id="divobserv">
  <?php echo label_for('fapresup[observ]', __($labels['fapresup{observ}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapresup{observ}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapresup{observ}')): ?>
    <?php echo form_error('fapresup{observ}', array('class' => 'form-error-msg')) ?>
  <?php endif; ?>

  <?php $value = object_textarea_tag($fapresup, 'getObserv', array (
  'size' => '90x3',
  'maxlength'=>500,
  'control_name' => 'fapresup[observ]',
)); echo $value ? $value : '&nbsp;' ?>
    </div>
</div>
<br/>
</div>
</fieldset>

<?php include_partial('edit_actions', array('fapresup' => $fapresup)) ?>

</form>

<ul class="sf_admin_actions">
      <li class="float-left"><?php if ($fapresup->getId()): ?>
<?php echo button_to(__('delete'), 'fapresup/delete?id='.$fapresup->getId(), array (
  'post' => true,
  'confirm' => __('Are you sure?'),
  'class' => 'sf_admin_action_delete',
)) ?><?php endif; ?>
</li>
  </ul>

<script type="text/javascript">


  var idf='<?php echo $fapresup->getId()?>';
  if (idf!="")
  {
    $$('.botoncat')[0].disabled=true;
    $('trigger_fapresup_fecpre').hide();
  }
  else{
    cargaprecio();
  }

  function enters(e,valor)
  {
   if (e.keyCode==13 || e.keyCode==9)
   {
     if (valor!='')
     { valor=valor.pad(8, '0',0);}
     else{valor=valor.pad(8, '#',0);}

     $('fapresup_refpre').value=valor;

   }
  }

  function perderfocus(e,id,totcol)
 {
   var aux = id.split("_");
   var name=aux[0];
   var fil=parseInt(aux[1]);
   var col=parseInt(aux[2]);

   if (col!=totcol)
   {
    var colsig=col+1;
    var siguiente=name+"_"+fil+"_"+colsig;
   }
   else
   {
    var fila=fil+1;
   	var siguiente=name+"_"+fila+"_1";
   }

   if (e.keyCode==13 || e.keyCode==9)
   {
     if($(siguiente))
     {
      if (!$(siguiente).readOnly) $(siguiente).focus();
     }
   }
  }

  function validarCambioCombos(){
   var idart01="ax_0_1";
   if($(idart01).value !=''){
      alert("Si cambia las selecciones del programa, condiciÃ³n de pago y el cliente pueden surgir cambios en la lista de artÃ­culos al guardar");

    }
   }

  $('fapresup_refpre').focus();
 </script>