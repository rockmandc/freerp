<?php
// auto-generated by PropelCidesa
// date: 2008/11/18 11:42:17
?>
<?php echo form_tag('fapedido/save', array(
  'id'        => 'sf_admin_edit_form',
  'name'      => 'sf_admin_edit_form',
  'multipart' => true,
)) ?>

<?php use_helper('Catalogo', 'Grid')?>
<?php echo javascript_include_tag('dFilter', 'ajax', 'facturacion/fapedido', 'tools') ?>

<?php echo object_input_hidden_tag($fapedido, 'getId') ?>
<?php echo input_hidden_tag('fapedido[reapor]', $fapedido->getReapor()) ?>
<?php echo input_hidden_tag('fapedido[codcli]', $fapedido->getCodcli()) ?>
<?php echo input_hidden_tag('fapedido[entrega]', $fapedido->getEntrega()) ?>
<?php echo object_input_hidden_tag($fapedido, 'getIncluircliente', array('id' => 'fapedido_incluircliente', 'name' => 'fapedido[incluircliente]')) ?>

<?php if($fapedido->getId()) : ?>
  <div class="warning-ok">
  <h2><?php echo $fapedido->getEstatus();?></h2>
  </div>
  <?php if($fapedido->Facturado()) : ?>
    <div class="warning-ok">
    <h2><?php echo $fapedido->FacturadoCon(); ?></h2>
    </div>
  <?php endif; ?>
<?php endif; ?>




<?php
  $fields = FapedidoPeer::getFieldNames();

  if(array_search('Codalmusu', $fields))
  {  ?>
  <h2 class="h2" onclick="javascript: return $('divusualms').toggle();"><?php echo __('Almacenes') ?></h2>
  <fieldset id="sf_fieldset_usualms" class="">
  <div class="form-row" id="divusualms">
    <?php echo label_for('fapedido[codalmusu]', __('Almacenes Por Usuario: '), 'class="required" Style="text-align:left; width:150px"') ?>
    <div class="content">
    <?php
      $almacenes = $sf_user->getAttribute('usualms',array());
      if(count($almacenes)>0){
        $keys = array_keys($almacenes);
        $codalm = $keys[0];
      }else $codalm = '';
      if($codalm == '') echo label_for('fapedido[codalmusu]', __('Usuario sin Almacen Asociado'), 'class="required" Style="text-align:left; width:150px"').'<br><br><br>';
      else echo select_tag('fapedido[codalmusu]',options_for_select($almacenes,$fapedido->getCodalmusu()!='' ? $fapedido->getCodalmusu() : $codalm), ( ($fapedido->getId()) ? 'disabled=true' : '').' style=width:500px');
    ?>
    </div>
  </div>
  </fieldset>
<?php } ?>

<h2 class="h2" onclick="javascript: return $('divDatos del Pedido').toggle();"><?php $et1=H::getConfApp2('etiquet2', 'facturacion', 'fapedido'); if ($et1!="") $vaet2=$et1; else $vaet2='Datos del Pedido'; echo __($vaet2) ?></h2>
<fieldset id="sf_fieldset_datos_del_pedido" class="">

<div class="form-row" id="divDatos del Pedido">

<table>
  <tr>
    <th>
		<div id="divnroped">
		  <?php echo label_for('fapedido[nroped]', __($labels['fapedido{nroped}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapedido{nroped}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapedido{nroped}')): ?>
		    <?php echo form_error('fapedido{nroped}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_input_tag($fapedido, 'getNroped', array (
		  'size' => 20,
		  'maxlength' => 8,
		  'readonly'  =>  $fapedido->getId()!='' ? true : false ,
		  'onKeyPress' => "javascript:if (event.keyCode==13 || event.keyCode==9){document.getElementById('fapedido_fecped').focus();}",
		  'onBlur'  => "javascript:event.keyCode=13; enter(event,this.value);",
		  'control_name' => 'fapedido[nroped]',
		)); echo $value ? $value : '&nbsp;' ?>
		    </div>
		</div>
	</th>
    <th>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
    <th>
		<div id="divfecped">
		  <?php echo label_for('fapedido[fecped]', __($labels['fapedido{fecped}' ]), 'class="required" Style="text-align:left; width:100px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapedido{fecped}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapedido{fecped}')): ?>
		    <?php echo form_error('fapedido{fecped}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_input_date_tag($fapedido, 'getFecped', array (
		  'rich' => true,
		  'readonly'  =>  $fapedido->getId()!='' ? true : false ,
		  'calendar_button_img' => '/sf/sf_admin/images/date.png',
		  'control_name' => 'fapedido[fecped]',
		  'date_format' => 'dd/MM/yyyy',
		  'onkeyup' => "javascript: mascara(this,'/',patron,true)",
		),date('Y-m-d')); echo $value ? $value : '&nbsp;' ?>
		    </div>
		</div>
	</th>
  </tr>
</table>

<br/>

<table>
  <tr>
    <th>
		<div id="divtipref">
		  <?php echo label_for('fapedido[tipref]', __($labels['fapedido{tipref}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapedido{tipref}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapedido{tipref}')): ?>
		    <?php echo form_error('fapedido{tipref}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

           <?php echo select_tag('fapedido[tipref]', options_for_select(Constantes::ListaRefiereAgro(),$fapedido->getTipref()),array(
             'onchange' => "habilitarefere(this.id)",
	       )) ?>

		    </div>
		</div>
    </th>
    <th>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>

    <th>
    <div id="divfecicon" style="display: none">
  <?php if($labels['fapedido{fecicon}']!='.:') { ?>
  <?php echo label_for('fapedido[fecicon]', __($labels['fapedido{fecicon}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{fecicon}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{fecicon}')): ?>
    <?php echo form_error('fapedido{fecicon}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>



  <?php $value = object_input_date_tag($fapedido, 'getFecicon', array (
  'rich' => true,
  'onkeyup' => 'javascript: mascara(this,\'/\',patron,true)',
  'calendar_button_img' => '/sf/sf_admin/images/date.png',
  'control_name' => 'fapedido[fecicon]',
  'date_format' => 'dd/MM/yyyy',
)); echo $value ? $value : '&nbsp;' ?>


  <?php if($labels['fapedido{fecicon}']!='.:') { ?>



  </div>
  <?php  } ?>

</div>
    </th>
    <th><div id="divfecfcon" style="display: none">
  <?php if($labels['fapedido{fecfcon}']!='.:') { ?>
  <?php echo label_for('fapedido[fecfcon]', __($labels['fapedido{fecfcon}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{fecfcon}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{fecfcon}')): ?>
    <?php echo form_error('fapedido{fecfcon}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>



  <?php $value = object_input_date_tag($fapedido, 'getFecfcon', array (
  'rich' => true,
  'onkeyup' => 'javascript: mascara(this,\'/\',patron,true)',
  'calendar_button_img' => '/sf/sf_admin/images/date.png',
  'control_name' => 'fapedido[fecfcon]',
  'date_format' => 'dd/MM/yyyy',
)); echo $value ? $value : '&nbsp;' ?>


  <?php if($labels['fapedido{fecfcon}']!='.:') { ?>



  </div>
  <?php  } ?>

</div></th>

  </tr>
</table>

<br/>

<table>
  <tr>
    <th>
		<div id="divrifpro">
		  <?php echo label_for('fapedido[rifpro]', __($labels['fapedido{rifpro}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapedido{rifpro}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapedido{rifpro}')): ?>
		    <?php echo form_error('fapedido{rifpro}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = get_partial('rifpro', array('type' => 'edit', 'fapedido' => $fapedido)); echo $value ? $value : '&nbsp;' ?>
		    </div>
		</div>
	</th>
  </tr>
</table>
<br>
<table>
  <tr>
    <th>
		<div id="divtipcte">
		  <?php echo label_for('fapedido[tipcte]', __($labels['fapedido{tipcte}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapedido{tipcte}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapedido{tipcte}')): ?>
		    <?php echo form_error('fapedido{tipcte}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php echo select_tag('fapedido[tipcte]', options_for_select(FatipctePeer::TiposCliente(),$fapedido->getCodtipcte())) ?>
		    </div>
		</div>
    </th>
    <th>
		<div id="divcodtip">
		  <?php echo object_input_hidden_tag($fapedido, 'getCodtipcte', array('id' => 'fapedido_codtip', 'name' => 'fapedido[codtip]')) ?>
		</div>
    </th>

</table>
<br>

<table>
  <tr>
    <th>

            <div id="divcodprg">
                <?php echo label_for('fapedido[codprg]', __($labels['fapedido{codprg}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
                <div class="content<?php if ($sf_request->hasError('fapedido{codprg}')): ?> form-error<?php endif; ?>">
                <?php if ($sf_request->hasError('fapedido{codprg}')): ?>
                <?php echo form_error('fapedido{codprg}', array('class' => 'form-error-msg')) ?>
                <?php endif; ?>
                <?php echo select_tag('fapedido[codprg]', options_for_select(FadefprgPeer::getProgramasVigentes(),$fapedido->getCodprg(),'include_custom=Seleccione uno'), array(
                        'onChange'=> "javascript:validarCambioCombos()"))?>

                </div>
            </div>
        </th>
    </tr>
</table>


<br>
<div id="divconcre">
     <?php echo label_for('fapedido[concre]', __($labels['fapedido{concre}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
        <div class="content<?php if ($sf_request->hasError('fapedido{concre}')): ?> form-error<?php endif; ?>">
     <?php if ($sf_request->hasError('fapedido{concre}')): ?>
        <?php echo form_error('fapedido{concre}', array('class' => 'form-error-msg')) ?>
     <?php endif; ?>

      <?php echo radiobutton_tag('fapedido[concre]', 'C', false,array('onClick'=> remote_function(array(
           'update'   => 'comboconpag',
           'url'      => 'fapedido/ajax',
           'complete' => 'AjaxJSON(request, json)',
           'script'   => true,
           'with'   => "'ajax=9&codprg='+$('fapedido_codprg').value+'&cliente='+$('fapedido_rifpro').value+'&codigo='+this.value"
            ))))        ."Contado".'&nbsp;&nbsp;';
            echo radiobutton_tag('fapedido[concre]', 'R', false,array('onClick'=> remote_function(array(
           'update'   => 'comboconpag',
           'url'      => 'fapedido/ajax',
           'complete' => 'AjaxJSON(request, json)',
           'script'   => true,
           'with'   => "'ajax=9&codprg='+$('fapedido_codprg').value+'&cliente='+$('fapedido_rifpro').value+'&codigo='+this.value"
            ))))."   Crédito";?>

     </div>
</div>
<br>

<br>
<table>
    <tr>
        <th>
            <div id="divcodconpag">
            <?php echo label_for('fapedido[conpag_id]', __($labels['fapedido{conpag_id}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
            <div class="content<?php if ($sf_request->hasError('fapedido{conpag_id}')): ?> form-error<?php endif; ?>">
            <?php if ($sf_request->hasError('fapedido{conpag_id}')): ?>
            <?php echo form_error('fapedido{conpag_id}', array('class' => 'form-error-msg')) ?>
            <?php endif; ?>

                <div id="comboconpag">
                    <?php echo select_tag('fapedido[conpag_id]', options_for_select(FaconpagPeer::TipPagos(),$fapedido->getConpagId()),array(
                        'onChange'=> "javascript:validarCambioCombos()")) ?>
                </div>
            </div>
            </div>
        </th>
    </tr>
</table>

<br>

<table>
  <tr>
    <th>
		<div id="divtelcli">
		  <?php echo label_for('fapedido[telcli]', __($labels['fapedido{telcli}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapedido{telcli}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapedido{telcli}')): ?>
		    <?php echo form_error('fapedido{telcli}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_input_tag($fapedido, 'getTelcli', array (
		  'readonly' => true,
		  'control_name' => 'fapedido[telcli]',
		)); echo $value ? $value : '&nbsp;' ?>
		    </div>
		</div>
	</th>
    <th>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
    <th>
		<div id="divnitcli" style="display:none">
		  <?php echo label_for('fapedido[nitcli]', __($labels['fapedido{nitcli}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapedido{nitcli}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapedido{nitcli}')): ?>
		    <?php echo form_error('fapedido{nitcli}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_input_tag($fapedido, 'getNitcli', array (
		  'disabled' => true,
		  'control_name' => 'fapedido[nitcli]',
		)); echo $value ? $value : '&nbsp;' ?>
		    </div>
		</div>
    </th>
  </tr>
</table>

<br/>

<table>
  <tr>
    <th>
		<div id="divdircli">
		  <?php echo label_for('fapedido[dircli]', __($labels['fapedido{dircli}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapedido{dircli}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapedido{dircli}')): ?>
		    <?php echo form_error('fapedido{dircli}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_input_tag($fapedido, 'getDircli', array (
		  'readonly' => true,
		  'size' => 60,
		  'control_name' => 'fapedido[dircli]',
		)); echo $value ? $value : '&nbsp;' ?>
		    </div>
		</div>
	</th>
  </tr>
</table>

<br/>

<table>
  <tr>
    <th>
		<div id="divdesped">
		  <?php echo label_for('fapedido[desped]', __($labels['fapedido{desped}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapedido{desped}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapedido{desped}')): ?>
		    <?php echo form_error('fapedido{desped}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_input_tag($fapedido, 'getDesped', array (
		  'size' => 80,
		  'maxlength' => 250,
		  'control_name' => 'fapedido[desped]',
		)); echo $value ? $value : '&nbsp;' ?>
		    </div>
		</div>
	</th>
  </tr>
</table>

<br/>

<table>
  <tr>
    <th>
		<div id="divmonped">
		  <?php echo label_for('fapedido[monped]', __($labels['fapedido{monped}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapedido{monped}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapedido{monped}')): ?>
		    <?php echo form_error('fapedido{monped}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_input_tag($fapedido, array('getMonped',true), array (
		  'size' => 7,
		  'readonly' => true,
		  'onKeyPress' => 'return validaDecimal(event)',
		  'onBlur' => 'event.keyCode=13;return formatoDecimal(event,this.id)',
		  'control_name' => 'fapedido[monped]',
		)); echo $value ? $value : '&nbsp;' ?>
		    </div>
		</div>
	</th>
  </tr>
</table>

<br>

    <?php echo label_for('fapedido[exeiva]', __($labels['fapedido{exeiva}']), 'class="required" style="width: 130px"') ?>
    <div class="content<?php if ($sf_request->hasError('fapedido{exeiva}')): ?> form-error<?php endif; ?>">
    <?php if ($sf_request->hasError('fapedido{exeiva}')): ?>
    <?php echo form_error('fapedido{exeiva}', array('class' => 'form-error-msg')) ?>
    <?php endif; ?>

    <?php $value = object_checkbox_tag($fapedido, 'getExeiva', array (
    'control_name' => 'fapedido[exeiva]',
    //'onClick' => 'eliminarRecargos()',
    )); echo $value ? $value : '&nbsp;' ?>
</div>

<ul class="sf_admin_actions">
    <?php if ($fapedido->getId()) {?>
    <li class="float-rigth">
        <input name="Forma" type="button" value="Forma-Preimpresa" class="sf_admin_action_save" onClick="formapreimpresa()">
    </li>
    <?php }?>
</ul>
</div>
</fieldset>

<h2 class="h2" onclick="javascript: return $('divDetalle Pedido').toggle();"><?php $et2=H::getConfApp2('etiquet3', 'facturacion', 'fapedido'); if ($et2!="") $vaet3=$et2; else $vaet3='Detalle Pedido'; echo __($vaet3) ?></h2>
<fieldset id="sf_fieldset_detalle_pedido" class="">

<div class="form-row" id="divDetalle Pedido">
<div id="combosl" style="display:none">
<?php echo label_for('fapedido[combo]', __($labels['fapedido{combo}' ]), 'class="required" Style="text-align:left; width:100px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{combo}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{combo}')): ?>
    <?php echo form_error('fapedido{combo}', array('class' => 'form-error-msg')) ?>
  <?php endif; ?>

  <?php echo input_auto_complete_tag('fapedido[combo]', $fapedido->getCombo(),
    'fapedido/autocomplete?ajax=1',  array('autocomplete' => 'off','maxlength' => 6,
    'readonly'  =>  $fapedido->getId()!='' ? true : false ,
    'onBlur'=>'colocargrid2(this.id)'
    ),
     array('use_style' => 'true')
  )?>
&nbsp; 		&nbsp;		&nbsp;
 <?php echo  button_to_popup('...',cross_app_link_to('herramientas','catalogo').'/metodo/Fadefcom_Fapedido/clase/Fadefcom/frame/sf_admin_edit_form/obj1/fapedido_combo/campo1/codcom','','','botoncat')?>
    </div>
<br>
</div>
<div id="divgrid">
  <?php if($labels['fapedido{grid}']!='.:') { ?>
  <?php echo label_for('fapedido[grid]', __($labels['fapedido{grid}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{grid}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{grid}')): ?>
    <?php echo form_error('fapedido{grid}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>
  <div id="articulos">
  <?php $value = get_partial('grid', array('type' => 'edit', 'fapedido' => $fapedido)); echo $value ? $value : '&nbsp;' ?>
  </div>
      <?php if($labels['fapedido{grid}']!='.:') { ?>
  <?php echo input_hidden_tag('fapedido[com]', $fapedido->getCom()) ?>
  <?php echo input_hidden_tag('fapedido[fil]', $fapedido->getFil()) ?>
    </div>
    <?php  } ?>
</div>
<br/>
</div>
</fieldset>
<h2 class="h2" onclick="javascript: return $('divFecha(s) de Entrega').toggle();"><?php echo __('Fecha(s) de Entrega') ?></h2>
<fieldset id="sf_fieldset_fecha_s__de_entrega" class="">

<div class="form-row" id="divFecha(s) de Entrega">
<div id="divgrid_fafecped">
 <?php if($labels['fapedido{grid_fafecped}']!='.:') { ?>
  <?php echo label_for('fapedido[grid_fafecped]', __($labels['fapedido{grid_fafecped}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{grid_fafecped}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{grid_fafecped}')): ?>
    <?php echo form_error('fapedido{grid_fafecped}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>

  <?php $value = get_partial('grid_fafecped', array('type' => 'edit', 'fapedido' => $fapedido)); echo $value ? $value : '&nbsp;' ?>

  <?php if($labels['fapedido{grid_fafecped}']!='.:') { ?>
    </div>
    <?php  } ?>
</div>
<br/>
</div>
</fieldset>
<h2 class="h2" onclick="javascript: return $('divObservación').toggle();"><?php echo __('Observación') ?></h2>
<fieldset id="sf_fieldset_observaci__n" class="">

<div class="form-row" id="divObservación">
<div id="divobsped">
  <?php echo label_for('fapedido[obsped]', __($labels['fapedido{obsped}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{obsped}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{obsped}')): ?>
    <?php echo form_error('fapedido{obsped}', array('class' => 'form-error-msg')) ?>
  <?php endif; ?>

  <?php $value = object_input_tag($fapedido, 'getObsped', array (
  'size' => 80,
  'maxlength' => 250,
  'control_name' => 'fapedido[obsped]',
)); echo $value ? $value : '&nbsp;' ?>
    </div>
</div>
<br/>
</div>
</fieldset>

<?php include_partial('edit_actions', array('fapedido' => $fapedido)) ?>

<!--</form>-->

<ul class="sf_admin_actions">
<li class="float-rigth">
<?php if ($fapedido->getId() && (!$fapedido->getEntrega() && $fapedido->getStatus()!='N' && !$fapedido->Facturado())) {?>
  <input type="button" name="Submit" value="Anular" class="sf_admin_action_delete" onclick="javascript:anular();" />
<?php }?>
</li>
<li class="float-rigth"><?php if ($fapedido->getId() && (!$fapedido->getEntrega()) && $fapedido->getStatus()!='N'): ?>
<?php echo button_to(__('delete'), 'fapedido/delete?id='.$fapedido->getId(), array (
  'confirm' => __('Are you sure?'),
  'class' => 'sf_admin_action_delete',
)) ?><?php endif; ?>
</li>
  </ul>

<script language="JavaScript" type="text/javascript">
var neww='<?php echo $fapedido->getId()?>';
var mansolped='<?php echo H::getConfApp2('mansolped', 'facturacion', 'fapedido'); ?>';
if (neww)
{
 $('trigger_fapedido_fecped').hide()
 $('fapedido_combo').readOnly=true;
 $$('.botoncat')[1].disabled=true;

 if (mansolped=='S')
    {
        if ($('fapedido_tipref').value=='PE')
        {
        $('divrefped').hide();
        $('divfecicon').show();
        $('divfecfcon').show();
        }
    }

}else {
    if (mansolped=='S')
    {
        $('fapedido_tipref').value='PE';
        habilitarefere('fapedido_tipref');
        $('divrefped').hide();
        $('divfecicon').show();
        $('divfecfcon').show();
    }
}
 //$$('.botoncat')[0].disabled=true;
 function enter(e,valor)
 {
   if (e.keyCode==13 || e.keyCode==9)
   {
     if (valor!='')
     { valor=valor.pad(8, '0',0);}
     else {
         valor=valor.pad(8, '#',0);
     }


     $('fapedido_nroped').value=valor;
   }
 }

 function habilitarefere(id)
 {
 	var neww='<?php echo $fapedido->getId()?>';
 if ($(id).value!="" && neww=="")
 {
 	if ($(id).value=='PR')
 	{

      $('fapedido_rifpro').readOnly=false;
      $$('.botoncat')[1].disabled=false;
      $('fapedido_combo').readOnly=true;
      $$('.botoncat')[2].disabled=true;
 	}
 	else
 	{
      $('fapedido_rifpro').readOnly=false;
      $$('.botoncat')[1].disabled=false;
      $$('.botoncat')[2].disabled=false;
 	}
 }
 }

  function perderfocus(e,id,totcol)
 {
   var aux = id.split("_");
   var name=aux[0];
   var fil=parseInt(aux[1]);
   var col=parseInt(aux[2]);

   if (col!=totcol)
   {
    var colsig=col+1;
    var siguiente=name+"_"+fil+"_"+colsig;
   }
   else
   {
    var fila=fil+1;
   	var siguiente=name+"_"+fila+"_1";
   }

   if (e.keyCode==13 || e.keyCode==9)
   {
     if($(siguiente))
     {
      if (!$(siguiente).readOnly) $(siguiente).focus();
     }
   }
  }

  function anular()
  {
    var referencia=$('fapedido_nroped').value;
    var nroped=$('fapedido_nroped').value;
    var fecped=$('fapedido_fecped').value;

    window.open('/facturacion'+getEnv()+'.php/fapedido/anular?nroped='+nroped+'&referencia='+referencia+'&fecped='+fecped,'...','menubar=no,toolbar=no,scrollbars=yes,width=700,height=400,resizable=yes,left=400,top=120');
  }

  function cargarcombosart()
  {
  	var neww='<?php echo $fapedido->getId()?>';
  	if ($('fapedido_combo').value!="" && neww=="")
  	{
     new Ajax.Updater('articulos', getUrlModulo()+'ajax', {asynchronous:true, evalScripts:true, onComplete:function(request, json){AjaxJSON(request, json)}, parameters:'ajax=7'});
  	}
  }

function colocargrid(id)
{
 var neww='<?php echo $fapedido->getId()?>';
 if ($('fapedido_refped').value!="" && neww=="")
 {
  var cod=$(id).value;
  new Ajax.Updater('articulos', getUrlModulo()+'ajax', {asynchronous:true, evalScripts:true, onComplete:function(request, json){AjaxJSON(request, json)}, parameters:'ajax=4&docref='+$('fapedido_tipref').value+'&cajtexmos=fapedido_codcli&codigo='+cod});
  setTimeout('otra()',5000)
 }

}

function colocargrid2(id)
{
  var neww='<?php echo $fapedido->getId()?>';
  if ($('fapedido_combo').value!="" && neww=="")
  {
   var cod=$(id).value;
   new Ajax.Updater('articulos', getUrlModulo()+'ajax', {asynchronous:true, evalScripts:true, onComplete:function(request, json){AjaxJSON(request, json)}, parameters:'ajax=7&codcom='+cod});
   setTimeout('otra()',5000)
  }
}

function otra()
{
  var comb=$('fapedido_com').value;
  if (comb!='1')
  {
   llenargridfechas();
   monto_total();
  }
  else
  {
   var fil=parseInt($('fapedido_fil').value);
   var i=0;
   while (i<fil)
   {
    var id1="ax"+"_"+i+"_1";
    var id2="ax"+"_"+i+"_2";
    var id3="ax"+"_"+i+"_3";

    $(id3).value='1,00';
    Cantidad2(id3);
    i++;
   }
  }
}

  function formapreimpresa()
  {
      var  nroped='<? echo $fapedido->getNroped();?>';
      var  codcli='<? echo $fapedido->getCodcli();?>';
      var  fecped=$('fapedido_fecped').value;
      var  ruta='http://'+'<?echo $this->getContext()->getRequest()->getHost();?>';

      pagina=ruta+"/<?php echo $sf_user->getAttribute('reportes_web');?>/facturacion/r.php?r=farpedido.php&coddes="+nroped+"&codhas="+nroped+"&clides="+codcli+"&clihas="+codcli+"&fechades="+fecped+"&fechahas="+fecped;

      window.open(pagina,nroped,"menubar=yes,toolbar=yes,scrollbars=yes,width=1200,height=800,resizable=yes,left=1000,top=80");
  }
  function validarCambioCombos(){
    var idart01="ax_0_1";
    if($(idart01).value !=''){
       if(confirm("Si cambia las selecciones del programa, condición de pago y el cliente se borrará la lista de artículos pedidos, ¿Está de acuerdo?"))
           alert("Debo borrar el grid");
           toAjaxUpdater('divDetalle Pedido',10,'ajax','','return true;','');
       }else{

       }
     }

$('fapedido_nroped').focus();
$('fapedido_tipcte').disabled=true;

</script>

 

