<?php
// auto-generated by PropelCidesa
// date: 2008/11/18 11:42:17
?>
<?php echo form_tag('fapedido/save', array(
  'id'        => 'sf_admin_edit_form',
  'name'      => 'sf_admin_edit_form',
  'multipart' => true,
)) ?>

<?php use_helper('Catalogo', 'Grid')?>
<?php echo javascript_include_tag('dFilter', 'ajax', 'facturacion/facturas', 'tools') ?>

<?php echo object_input_hidden_tag($fapedido, 'getId') ?>
<?php echo input_hidden_tag('fapedido[reapor]', $fapedido->getReapor()) ?>
<?php echo input_hidden_tag('fapedido[codcli]', $fapedido->getCodcli()) ?>
<?php echo input_hidden_tag('fapedido[entrega]', $fapedido->getEntrega()) ?>
<?php echo input_hidden_tag('fapedido[codpai]', $fapedido->getCodpai()) ?>
<?php echo object_input_hidden_tag($fapedido, 'getFilactrec', array('id' => 'fapedido_filactrec', 'name' => 'fapedido[filactrec]')) ?>
<?php echo object_input_hidden_tag($fapedido, 'getTrajo', array('id' => 'fapedido_trajo', 'name' => 'fapedido[trajo]')) ?>
<table width="100%">
  <tr>
    <th><strong><font color="#CC0000" size="2" face="Verdana, Arial, Helvetica, sans-serif"> <? print $fapedido->getEstatus();?></font></strong></th>
  </tr>
</table>

<h2 class="h2" onclick="javascript: return $('divDatos del Pedido').toggle();"><?php $et1=H::getConfApp2('etiquet2', 'facturacion', 'fapedido'); if ($et1!="") $vaet2=$et1; else $vaet2='Datos del Pedido'; echo __($vaet2) ?></h2>
<fieldset id="sf_fieldset_datos_del_pedido" class="">

<div class="form-row" id="divDatos del Pedido">

<table>
  <tr>
    <th>
		<div id="divnroped">
		  <?php echo label_for('fapedido[nroped]', __($labels['fapedido{nroped}' ]), 'class="required" Style="text-align:left; width:50px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapedido{nroped}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapedido{nroped}')): ?>
		    <?php echo form_error('fapedido{nroped}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_input_tag($fapedido, 'getNroped', array (
		  'size' => 20,
		  'maxlength' => 8,
		  'readonly'  =>  $fapedido->getId()!='' ? true : false ,
		  'onKeyPress' => "javascript:if (event.keyCode==13 || event.keyCode==9){document.getElementById('fapedido_fecped').focus();}",
		  'onBlur'  => "javascript:event.keyCode=13; enter(event,this.value);",
		  'control_name' => 'fapedido[nroped]',
		)); echo $value ? $value : '&nbsp;' ?>
		    </div>
		</div>
	</th>
    <th>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
    <th>
		<div id="divfecped">
		  <?php echo label_for('fapedido[fecped]', __($labels['fapedido{fecped}' ]), 'class="required" Style="text-align:left; width:50px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapedido{fecped}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapedido{fecped}')): ?>
		    <?php echo form_error('fapedido{fecped}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_input_date_tag($fapedido, 'getFecped', array (
		  'rich' => true,
		  'readonly'  =>  $fapedido->getId()!='' ? true : false ,
		  'calendar_button_img' => '/sf/sf_admin/images/date.png',
		  'control_name' => 'fapedido[fecped]',
		  'date_format' => 'dd/MM/yyyy',
		  'onkeyup' => "javascript: mascara(this,'/',patron,true)",
		),date('Y-m-d')); echo $value ? $value : '&nbsp;' ?>
		    </div>
		</div>
	</th>
  </tr>
</table>

<br/>

<table>
  <tr>
    <th>
		<div id="divtipref">
		  <?php echo label_for('fapedido[tipref]', __($labels['fapedido{tipref}' ]), 'class="required" Style="text-align:left; width:50px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapedido{tipref}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapedido{tipref}')): ?>
		    <?php echo form_error('fapedido{tipref}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

           <?php echo select_tag('fapedido[tipref]', options_for_select(Constantes::ListaRefiere(),$fapedido->getTipref(),'include_custom=Seleccione Uno'),array(
             'onchange' => "habilitarefere(this.id)",
	       )) ?>

		    </div>
		</div>
    </th>
    <th>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
    <th>
		<div id="divrefped">
		  <?php echo label_for('fapedido[refped]', __($labels['fapedido{refped}' ]), 'class="required" Style="text-align:left; width:50px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapedido{refped}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapedido{refped}')): ?>
		    <?php echo form_error('fapedido{refped}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_input_tag($fapedido, 'getRefped', array (
		  'size' => 20,
		  'readonly' => true,
		  'control_name' => 'fapedido[refped]',
		  'onBlur'=> 'colocargrid(this.id);'
		)); echo $value ? $value : '&nbsp;' ?>
		&nbsp; 		&nbsp;		&nbsp;
		 <?php echo  button_to_popup('...',cross_app_link_to('herramientas','catalogo').'/metodo/Fapresup_Fapedido/clase/Fapresup/frame/sf_admin_edit_form/obj1/fapedido_refped/campo1/refpre','','','botoncat')?>
		    </div>
		</div>
    </th>
    <th>
    <div id="divfecicon" style="display: none">
  <?php if($labels['fapedido{fecicon}']!='.:') { ?>
  <?php echo label_for('fapedido[fecicon]', __($labels['fapedido{fecicon}' ]), 'class="required" Style="text-align:left; width:50px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{fecicon}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{fecicon}')): ?>
    <?php echo form_error('fapedido{fecicon}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>  
  
   
  
  <?php $value = object_input_date_tag($fapedido, 'getFecicon', array (
  'rich' => true,
  'onkeyup' => 'javascript: mascara(this,\'/\',patron,true)',
  'calendar_button_img' => '/sf/sf_admin/images/date.png',
  'control_name' => 'fapedido[fecicon]',
  'date_format' => 'dd/MM/yyyy',
)); echo $value ? $value : '&nbsp;' ?>
      
		
  <?php if($labels['fapedido{fecicon}']!='.:') { ?>  
  

   
  </div>
  <?php  } ?> 

</div>
    </th>
    <th><div id="divfecfcon" style="display: none">
  <?php if($labels['fapedido{fecfcon}']!='.:') { ?>
  <?php echo label_for('fapedido[fecfcon]', __($labels['fapedido{fecfcon}' ]), 'class="required" Style="text-align:left; width:50px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{fecfcon}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{fecfcon}')): ?>
    <?php echo form_error('fapedido{fecfcon}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>  
  
   
  
  <?php $value = object_input_date_tag($fapedido, 'getFecfcon', array (
  'rich' => true,
  'onkeyup' => 'javascript: mascara(this,\'/\',patron,true)',
  'calendar_button_img' => '/sf/sf_admin/images/date.png',
  'control_name' => 'fapedido[fecfcon]',
  'date_format' => 'dd/MM/yyyy',
)); echo $value ? $value : '&nbsp;' ?>
      
		
  <?php if($labels['fapedido{fecfcon}']!='.:') { ?>  
  

   
  </div>
  <?php  } ?> 

</div></th>

  </tr>
</table>

<br/>

<table>
  <tr>
    <th>
		<div id="divrifpro">
		  <?php echo label_for('fapedido[rifpro]', __($labels['fapedido{rifpro}' ]), 'class="required" Style="text-align:left; width:50px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapedido{rifpro}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapedido{rifpro}')): ?>
		    <?php echo form_error('fapedido{rifpro}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = get_partial('rifpro', array('type' => 'edit', 'fapedido' => $fapedido)); echo $value ? $value : '&nbsp;' ?>
		    </div>
		</div>
	</th>
  </tr>
</table>

<br/>

<table>
  <tr>
    <th>
		<div id="divtelcli">
		  <?php echo label_for('fapedido[telcli]', __($labels['fapedido{telcli}' ]), 'class="required" Style="text-align:left; width:50px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapedido{telcli}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapedido{telcli}')): ?>
		    <?php echo form_error('fapedido{telcli}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_input_tag($fapedido, 'getTelcli', array (
		  'disabled' => true,
		  'control_name' => 'fapedido[telcli]',
		)); echo $value ? $value : '&nbsp;' ?>
		    </div>
		</div>
	</th>
    <th>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
    <th>
		<div id="divnitcli" style="display:none">
		  <?php echo label_for('fapedido[nitcli]', __($labels['fapedido{nitcli}' ]), 'class="required" Style="text-align:left; width:50px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapedido{nitcli}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapedido{nitcli}')): ?>
		    <?php echo form_error('fapedido{nitcli}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_input_tag($fapedido, 'getNitcli', array (
		  'disabled' => true,
		  'control_name' => 'fapedido[nitcli]',
		)); echo $value ? $value : '&nbsp;' ?>
		    </div>
		</div>
    </th>
  </tr>
</table>

<br/>

<table>
  <tr>
    <th>
		<div id="divdircli">
		  <?php echo label_for('fapedido[dircli]', __($labels['fapedido{dircli}' ]), 'class="required" Style="text-align:left; width:50px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapedido{dircli}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapedido{dircli}')): ?>
		    <?php echo form_error('fapedido{dircli}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_input_tag($fapedido, 'getDircli', array (
		  'disabled' => true,
		  'size' => 60,
		  'control_name' => 'fapedido[dircli]',
		)); echo $value ? $value : '&nbsp;' ?>
		    </div>
		</div>
	</th>
  </tr>
</table>

<br/>

<table>
  <tr>
    <th>
		<div id="divdesped">
		  <?php echo label_for('fapedido[desped]', __($labels['fapedido{desped}' ]), 'class="required" Style="text-align:left; width:50px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapedido{desped}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapedido{desped}')): ?>
		    <?php echo form_error('fapedido{desped}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_input_tag($fapedido, 'getDesped', array (
		  'size' => 80,
		  'maxlength' => 250,
		  'control_name' => 'fapedido[desped]',
		)); echo $value ? $value : '&nbsp;' ?>
		    </div>
		</div>
	</th>
  </tr>
</table>
<br/>
<div id="divcoddirec">
  <?php if($labels['fapedido{coddirec}']!='.:') { ?>
  <?php echo label_for('fapedido[coddirec]', __($labels['fapedido{coddirec}' ]), 'class="required" ') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{coddirec}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{coddirec}')): ?>
    <?php echo form_error('fapedido{coddirec}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>  
  
    
  <?php echo Catalogo($fapedido, 15, array (
  'getprincipal' => 'getCoddirec',
  'getsecundario' => 'getDesdirec',
  'campoprincipal' => 'coddirec',
  'camposecundario' => 'desdirec',
  'campobase' => 'id',
),  'Cadefdirec_Almdefdiv',  'Cadefdirec',  '',  '',  '');?>

  	
  <?php if($labels['fapedido{coddirec}']!='.:') { ?>  
  

   
  </div>
  <?php  } ?> 

</div>
<br/>

<table>
  <tr>
    <th>

            <div id="divcodprg">
                <?php echo label_for('fapedido[codprg]', __($labels['fapedido{codprg}' ]), 'class="required" Style="text-align:left; width:50px"') ?>
                <div class="content<?php if ($sf_request->hasError('fapedido{codprg}')): ?> form-error<?php endif; ?>">
                <?php if ($sf_request->hasError('fapedido{codprg}')): ?>
                <?php echo form_error('fapedido{codprg}', array('class' => 'form-error-msg')) ?>
                <?php endif; ?>
                <?php echo select_tag('fapedido[codprg]', options_for_select(FadefprgPeer::getProgramasForCombo(),$fapedido->getCodprg(),'include_custom=Seleccione uno'), array(
	                'onChange'=> remote_function(array(
						'url'      => 'fapedido/ajax?ajax=11',
						'complete' => 'AjaxJSON(request, json)',
                        'condition' => "$('fapedido_codprg').value != '' && $('id').value == ''",
						'with' => "'codigo='+this.value"
				     ))
				  ))?>

                </div>
            </div>
        </th>
    </tr>
</table>

<br>
<div id="datospae" style="display:none">
<div id="divfecdes">
  <?php if($labels['fapedido{fecdes}']!='.:') { ?>
  <?php echo label_for('fapedido[fecdes]', __($labels['fapedido{fecdes}' ]), 'class="required" Style="text-align:left; width:50px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{fecdes}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{fecdes}')): ?>
    <?php echo form_error('fapedido{fecdes}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>    
  
  <?php $value = object_input_date_tag($fapedido, 'getFecdes', array (
  'rich' => true,
  'onkeyup' => 'javascript: mascara(this,\'/\',patron,true)',
  'calendar_button_img' => '/sf/sf_admin/images/date.png',
  'control_name' => 'fapedido[fecdes]',
  'date_format' => 'dd/MM/yyyy',
)); echo $value ? $value : '&nbsp;' ?>    
		
  <?php if($labels['fapedido{fecdes}']!='.:') { ?>     
  </div>
  <?php  } ?> 

</div>
<br/>
<div id="divfechas">
  <?php if($labels['fapedido{fechas}']!='.:') { ?>
  <?php echo label_for('fapedido[fechas]', __($labels['fapedido{fechas}' ]), 'class="required" Style="text-align:left; width:50px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{fechas}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{fechas}')): ?>
    <?php echo form_error('fapedido{fechas}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>  
  
   
  
  <?php $value = object_input_date_tag($fapedido, 'getFechas', array (
  'rich' => true,
  'onkeyup' => 'javascript: mascara(this,\'/\',patron,true)',
  'calendar_button_img' => '/sf/sf_admin/images/date.png',
  'control_name' => 'fapedido[fechas]',
  'date_format' => 'dd/MM/yyyy',
)); echo $value ? $value : '&nbsp;' ?>  
		
  <?php if($labels['fapedido{fechas}']!='.:') { ?>    
  </div>
  <?php  } ?> 

</div>
<br/>	
<div id="divcodedo">
  <?php if($labels['fapedido{codedo}']!='.:') { ?>
  <?php echo label_for('fapedido[codedo]', __($labels['fapedido{codedo}' ]), 'class="required" Style="text-align:left; width:50px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{codedo}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{codedo}')): ?>
    <?php echo form_error('fapedido{codedo}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>    
  
  <?php echo select_tag('fapedido[codedo]', options_for_select(OcestadoPeer::ObtenerEstados($fapedido->getCodpai()),$fapedido->getCodedo(),'include_custom=Seleccione'),array(
	 'onChange'=> remote_function(array(
		'update'   => 'divCiudad',
		'url'      => 'fapedido/ajax?ajax=8',
		'complete' => 'AjaxJSON(request, json)',
        'condition' => "$('fapedido_codedo').value != '' && $('id').value == ''",
		'with' => "'pais='+$('fapedido_codpai').value+'&codigo='+this.value"
  ))));?>      
		
  <?php if($labels['fapedido{codedo}']!='.:') { ?>     
  </div>
  <?php  } ?> 
</div>
<br/>
<div id="divcodciu">
  <?php if($labels['fapedido{codciu}']!='.:') { ?>
  <?php echo label_for('fapedido[codciu]', __($labels['fapedido{codciu}' ]), 'class="required" Style="text-align:left; width:50px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{codciu}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{codciu}')): ?>
    <?php echo form_error('fapedido{codciu}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>  
  
<div id="divCiudad">
<?php echo select_tag('fapedido[codciu]', options_for_select(OcciudadPeer::ObtenerCiudades($fapedido->getCodedo(),$fapedido->getCodpai()),$fapedido->getCodciu(),'include_custom=Seleccione'),array(
	'onChange'=> remote_function(array(
		'update'   => 'divMunicipio',
		'url'      => 'fapedido/ajax?ajax=9',
		'complete' => 'AjaxJSON(request, json)',
        'condition' => "$('fapedido_codciu').value != '' && $('id').value == ''",
		'with' => "'estado='+$('fapedido_codedo').value+'&pais='+$('fapedido_codpai').value+'&codigo='+this.value"
  ))));?></div>      		
  <?php if($labels['fapedido{codciu}']!='.:') { ?>   
  </div>
  <?php  } ?> 
</div>
<br/>
<div id="divcodmun">
  <?php if($labels['fapedido{codmun}']!='.:') { ?>
  <?php echo label_for('fapedido[codmun]', __($labels['fapedido{codmun}' ]), 'class="required" Style="text-align:left; width:50px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{codmun}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{codmun}')): ?>
    <?php echo form_error('fapedido{codmun}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>  
  
<div id="divMunicipio">
<?php echo select_tag('fapedido[codmun]', options_for_select(OcmuniciPeer::ObtenerMunicipios($fapedido->getCodciu(),$fapedido->getCodedo(),$fapedido->getCodpai()),$fapedido->getCodmun(),'include_custom=Seleccione'),array(
	'onChange'=> remote_function(array(
		'update'   => 'divParroquia',
		'url'      => 'fapedido/ajax?ajax=10',
		'complete' => 'AjaxJSON(request, json)',
        'condition' => "$('fapedido_codmun').value != '' && $('id').value == ''",
		'with' => "'ciudad='+$('fapedido_codciu').value+'&estado='+$('fapedido_codedo').value+'&pais='+$('fapedido_codpai').value+'&codigo='+this.value"
  ))));?></div>       		
  <?php if($labels['fapedido{codmun}']!='.:') { ?>    
  </div>
  <?php  } ?> 

</div>
<br/>
<div id="divcodpar">
  <?php if($labels['fapedido{codpar}']!='.:') { ?>
  <?php echo label_for('fapedido[codpar]', __($labels['fapedido{codpar}' ]), 'class="required" Style="text-align:left; width:50px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{codpar}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{codpar}')): ?>
    <?php echo form_error('fapedido{codpar}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>  
  
   
  
<div id="divParroquia">
<?php echo select_tag('fapedido[codpar]', options_for_select(OcparroqPeer::ObtenerParroquias($fapedido->getCodmun(),$fapedido->getCodedo(),$fapedido->getCodpai()),$fapedido->getCodpar(),'include_custom=Seleccione'),array(
	));?></div>  		
  <?php if($labels['fapedido{codpar}']!='.:') { ?>     
  </div>
  <?php  } ?> 

</div>
</div>	
<br/>

<table>
  <tr>
    <th>
		<div id="divmonped">
		  <?php echo label_for('fapedido[monped]', __($labels['fapedido{monped}' ]), 'class="required" Style="text-align:left; width:50px"') ?>
		  <div class="content<?php if ($sf_request->hasError('fapedido{monped}')): ?> form-error<?php endif; ?>">
		  <?php if ($sf_request->hasError('fapedido{monped}')): ?>
		    <?php echo form_error('fapedido{monped}', array('class' => 'form-error-msg')) ?>
		  <?php endif; ?>

		  <?php $value = object_input_tag($fapedido, array('getMonped',true), array (
		  'size' => 7,
		  'readonly' => true,
		  'onKeyPress' => 'return validaDecimal(event)',
		  'onBlur' => 'event.keyCode=13;return formatoDecimal(event,this.id)',
		  'control_name' => 'fapedido[monped]',
		)); echo $value ? $value : '&nbsp;' ?>
		    </div>
		</div>
	</th>
  </tr>
</table>

<br>

    <?php echo label_for('fapedido[exeiva]', __($labels['fapedido{exeiva}']), 'class="required" style="width: 100px"') ?>
    <div class="content<?php if ($sf_request->hasError('fapedido{exeiva}')): ?> form-error<?php endif; ?>">
    <?php if ($sf_request->hasError('fapedido{exeiva}')): ?>
    <?php echo form_error('fapedido{exeiva}', array('class' => 'form-error-msg')) ?>
    <?php endif; ?>

    <?php $value = object_checkbox_tag($fapedido, 'getExeiva', array (
    'control_name' => 'fapedido[exeiva]',
    //'onClick' => 'eliminarRecargos()',
    )); echo $value ? $value : '&nbsp;' ?>
</div>

<ul class="sf_admin_actions">
    <?php if ($fapedido->getId()) {?>
    <li class="float-rigth">
        <input name="Forma" type="button" value="Forma-Preimpresa" class="sf_admin_action_save" onClick="formapreimpresa()">
    </li>
    <?php }?>
</ul>
</div>
</fieldset>

<h2 class="h2" onclick="javascript: return $('divDetalle Pedido').toggle();"><?php $et2=H::getConfApp2('etiquet3', 'facturacion', 'fapedido'); if ($et2!="") $vaet3=$et2; else $vaet3='Detalle Pedido'; echo __($vaet3) ?></h2>
<fieldset id="sf_fieldset_detalle_pedido" class="">

<div class="form-row" id="divDetalle Pedido">
<div id="combosl" style="display:none">
<?php echo label_for('fapedido[combo]', __($labels['fapedido{combo}' ]), 'class="required" Style="text-align:left; width:100px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{combo}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{combo}')): ?>
    <?php echo form_error('fapedido{combo}', array('class' => 'form-error-msg')) ?>
  <?php endif; ?>

  <?php echo input_auto_complete_tag('fapedido[combo]', $fapedido->getCombo(),
    'fapedido/autocomplete?ajax=1',  array('autocomplete' => 'off','maxlength' => 6,
    'readonly'  =>  $fapedido->getId()!='' ? true : false ,
    'onBlur'=>'colocargrid2(this.id)'
    ),
     array('use_style' => 'true')
  )?>
&nbsp; 		&nbsp;		&nbsp;
 <?php echo  button_to_popup('...',cross_app_link_to('herramientas','catalogo').'/metodo/Fadefcom_Fapedido/clase/Fadefcom/frame/sf_admin_edit_form/obj1/fapedido_combo/campo1/codcom','','','botoncat')?>
    </div>
<br>
</div>
<div id="datosRecarg" style="display:none">
<div id="divgrid_fargoped">
  <?php if($labels['fapedido{grid_fargoped}']!='.:') { ?>
  <?php echo label_for('fapedido[grid_fargoped]', __($labels['fapedido{grid_fargoped}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{grid_fargoped}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{grid_fargoped}')): ?>
    <?php echo form_error('fapedido{grid_fargoped}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>  

  <?php $value = get_partial('grid_fargoped', array('type' => 'edit', 'fapedido' => $fapedido)); echo $value ? $value : '&nbsp;' ?>

 <?php if($labels['fapedido{grid_fargoped}']!='.:') { ?>  
    </div>
 <?php  } ?> 
</div>
<br/>
<table>
<tr>
<th>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</th>
<th>
<?php echo link_to_function(image_tag('/images/salir.gif'), "salvarmontorecargosPed()") ?> <font color="#1630EE" size="1" face="Verdana, Arial, Helvetica, sans-serif">
<p align="center"><?php echo __('Ocultar') ?></p></font>
</th>
<th>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</th>
<th>
<div id="divtotrec" >
  <?php echo label_for('fapedido[totrec]', __($labels['fapedido{totrec}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{totrec}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{totrec}')): ?>
    <?php echo form_error('fapedido{totrec}', array('class' => 'form-error-msg')) ?>
  <?php endif; ?>

  <?php
 $value = object_input_tag($fapedido, 'getTotrec', array (
	'readonly' => true,
	'class' => 'grid_txtright',
	'control_name' => 'fapedido[totrec]',

));
echo $value ? $value : '&nbsp;'
?>
    </div>
</div>
</th></tr></table>
<br/>
</div>
<div id="divgrid">
  <?php if($labels['fapedido{grid}']!='.:') { ?>
  <?php echo label_for('fapedido[grid]', __($labels['fapedido{grid}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{grid}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{grid}')): ?>
    <?php echo form_error('fapedido{grid}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>  
  <div id="articulos">
  <?php $value = get_partial('grid', array('type' => 'edit', 'fapedido' => $fapedido)); echo $value ? $value : '&nbsp;' ?>
  </div>
      <?php if($labels['fapedido{grid}']!='.:') { ?>  
  <?php echo input_hidden_tag('fapedido[com]', $fapedido->getCom()) ?>
  <?php echo input_hidden_tag('fapedido[fil]', $fapedido->getFil()) ?>
    </div>
    <?php  } ?> 
</div>
<br/>
</div>
</fieldset>
<h2 class="h2" onclick="javascript: return $('divFecha(s) de Entrega').toggle();"><?php echo __('Fecha(s) de Entrega') ?></h2>
<fieldset id="sf_fieldset_fecha_s__de_entrega" class="">

<div class="form-row" id="divFecha(s) de Entrega">
<div id="divgrid_fafecped">
 <?php if($labels['fapedido{grid_fafecped}']!='.:') { ?>
  <?php echo label_for('fapedido[grid_fafecped]', __($labels['fapedido{grid_fafecped}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{grid_fafecped}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{grid_fafecped}')): ?>
    <?php echo form_error('fapedido{grid_fafecped}', array('class' => 'form-error-msg')) ?>
  <?php endif; }?>

  <?php $value = get_partial('grid_fafecped', array('type' => 'edit', 'fapedido' => $fapedido)); echo $value ? $value : '&nbsp;' ?>
      
  <?php if($labels['fapedido{grid_fafecped}']!='.:') { ?>  
    </div>
    <?php  } ?> 
</div>
<br/>
</div>
</fieldset>
<h2 class="h2" onclick="javascript: return $('divObservación').toggle();"><?php echo __('Observación') ?></h2>
<fieldset id="sf_fieldset_observaci__n" class="">

<div class="form-row" id="divObservación">
<div id="divobsped">
  <?php echo label_for('fapedido[obsped]', __($labels['fapedido{obsped}' ]), 'class="required" Style="text-align:left; width:150px"') ?>
  <div class="content<?php if ($sf_request->hasError('fapedido{obsped}')): ?> form-error<?php endif; ?>">
  <?php if ($sf_request->hasError('fapedido{obsped}')): ?>
    <?php echo form_error('fapedido{obsped}', array('class' => 'form-error-msg')) ?>
  <?php endif; ?>

  <?php $value = object_input_tag($fapedido, 'getObsped', array (
  'size' => 80,
  'maxlength' => 250,
  'control_name' => 'fapedido[obsped]',
)); echo $value ? $value : '&nbsp;' ?>
    </div>
</div>
<br/>
</div>
</fieldset>

<?php include_partial('edit_actions', array('fapedido' => $fapedido)) ?>

</form>

<ul class="sf_admin_actions">
<li class="float-rigth">
<?php if ($fapedido->getId() && (!$fapedido->getEntrega() && $fapedido->getStatus()!='N')) {?>
  <input type="button" name="Submit" value="Anular" class="sf_admin_action_delete" onclick="javascript:anular();" />
<?php }?>
</li>
<li class="float-rigth"><?php if ($fapedido->getId() && (!$fapedido->getEntrega()) && $fapedido->getStatus()!='N'): ?>
<?php echo button_to(__('delete'), 'fapedido/delete?id='.$fapedido->getId(), array (
  'post' => true,
  'confirm' => __('Are you sure?'),
  'class' => 'sf_admin_action_delete',
)) ?><?php endif; ?>
</li>
  </ul>

<script language="JavaScript" type="text/javascript">
var neww='<?php echo $fapedido->getId()?>';
var mansolped='<?php echo H::getConfApp2('mansolped', 'facturacion', 'fapedido'); ?>';
if (neww)
{
 $('trigger_fapedido_fecped').hide()
 $('fapedido_combo').readOnly=true;
 $$('.botoncat')[1].disabled=true;
 
 if (mansolped=='S')
    {
        if ($('fapedido_tipref').value=='PE')
        {        
        $('divrefped').hide();
        $('divfecicon').show();
        $('divfecfcon').show();
        }
    }

    fact='<?php echo $fapedido->Facturado()?>';
    desp='<?php echo $fapedido->Despachado()?>';
    
    if (fact || desp)
      $$('.sf_admin_action_save')[1].hide();

    espae='<?php echo H::getX_vacio("CODPRG","Fadefprg","Espae",$fapedido->getCodprg());?>';
    if (espae=='S')
    	$('datospae').show();
 
}else {    
    if (mansolped=='S')
    {
        $('fapedido_tipref').value='PE';
        habilitarefere('fapedido_tipref');
        $('divrefped').hide();
        $('divfecicon').show();
        $('divfecfcon').show();
    }
    
}
 $$('.botoncat')[0].disabled=true;
 function enter(e,valor)
 {
   if (e.keyCode==13 || e.keyCode==9)
   {
     if (valor!='')
     { valor=valor.pad(8, '0',0);}
     else {
         valor=valor.pad(8, '#',0);
     }


     $('fapedido_nroped').value=valor;
   }
 }

 function habilitarefere(id)
 {
 	var neww='<?php echo $fapedido->getId()?>';
 if ($(id).value!="" && neww=="")
 {
 	if ($(id).value=='PR')
 	{
      $('fapedido_refped').readOnly=false;
      $$('.botoncat')[0].disabled=false;
      $('fapedido_rifpro').readOnly=true;
      $$('.botoncat')[1].disabled=true;
      $('fapedido_combo').readOnly=true;
      $$('.botoncat')[2].disabled=true;
 	}
 	else
 	{
      $('fapedido_refped').readOnly=true;
      $$('.botoncat')[0].disabled=true;
      $('fapedido_rifpro').readOnly=false;
      $$('.botoncat')[1].disabled=false;
      $$('.botoncat')[2].disabled=false;
 	}
 }
 }

  function perderfocus(e,id,totcol)
 {
   var aux = id.split("_");
   var name=aux[0];
   var fil=parseInt(aux[1]);
   var col=parseInt(aux[2]);

   if (col!=totcol)
   {
    var colsig=col+1;
    var siguiente=name+"_"+fil+"_"+colsig;
   }
   else
   {
    var fila=fil+1;
   	var siguiente=name+"_"+fila+"_1";
   }

   if (e.keyCode==13 || e.keyCode==9)
   {
     if($(siguiente))
     {
      if (!$(siguiente).readOnly) $(siguiente).focus();
     }
   }
  }

  function anular()
  {
    var referencia=$('fapedido_nroped').value;
    var nroped=$('fapedido_nroped').value;
    var fecped=$('fapedido_fecped').value;

    window.open('/facturacion'+getEnv()+'.php/fapedido/anular?nroped='+nroped+'&referencia='+referencia+'&fecped='+fecped,'...','menubar=no,toolbar=no,scrollbars=yes,width=700,height=400,resizable=yes,left=400,top=120');
  }

  function cargarcombosart()
  {
  	var neww='<?php echo $fapedido->getId()?>';
  	if ($('fapedido_combo').value!="" && neww=="")
  	{
     new Ajax.Updater('articulos', getUrlModulo()+'ajax', {asynchronous:true, evalScripts:true, onComplete:function(request, json){AjaxJSON(request, json)}, parameters:'ajax=7'});
  	}
  }

function colocargrid(id)
{
 var neww='<?php echo $fapedido->getId()?>';
 if ($('fapedido_refped').value!="" && neww=="")
 {
  var cod=$(id).value;
  new Ajax.Updater('articulos', getUrlModulo()+'ajax', {asynchronous:true, evalScripts:true, onComplete:function(request, json){AjaxJSON(request, json)}, parameters:'ajax=4&docref='+$('fapedido_tipref').value+'&cajtexmos=fapedido_codcli&codigo='+cod});
  setTimeout('otra()',5000)
 }

}

function colocargrid2(id)
{
  var neww='<?php echo $fapedido->getId()?>';
  if ($('fapedido_combo').value!="" && neww=="")
  {
   var cod=$(id).value;
   new Ajax.Updater('articulos', getUrlModulo()+'ajax', {asynchronous:true, evalScripts:true, onComplete:function(request, json){AjaxJSON(request, json)}, parameters:'ajax=7&codcom='+cod});
   setTimeout('otra()',5000)
  }
}

function otra()
{
  var comb=$('fapedido_combo').value;
  if (comb!='1')
  {
   llenargridfechas();
   monto_total();
  }
  else
  {
   var fil=parseInt($('fapedido_fil').value);
   var i=0;
   while (i<fil)
   {
    var id1="ax"+"_"+i+"_1";
    var id2="ax"+"_"+i+"_2";
    var id3="ax"+"_"+i+"_3";

    $(id3).value='1,00';
    Cantidad2(id3);
    i++;
   }
  }
}

  function formapreimpresa()
  {
      var  nroped='<? echo $fapedido->getNroped();?>';
      var  codcli='<? echo $fapedido->getCodcli();?>';
      var  estatus='<? echo $fapedido->getStatus();?>';
      var  fecped=$('fapedido_fecped').value; 
      var  ruta='http://'+'<?echo $this->getContext()->getRequest()->getHost();?>';

      pagina=ruta+"/<?php echo $sf_user->getAttribute('reportes_web');?>/facturacion/r.php?r=farpedido.php&coddes="+nroped+"&codhas="+nroped+"&clides="+codcli+"&clihas="+codcli+"&fechades="+fecped+"&fechahas="+fecped+"&estatus="+estatus;

      window.open(pagina,nroped,"menubar=yes,toolbar=yes,scrollbars=yes,width=1200,height=800,resizable=yes,left=1000,top=80");      
  }
</script>

